{"ast":null,"code":"var _jsxFileName = \"E:\\\\fork\\\\frontend-111406\\\\frontend-111406\\\\src\\\\common\\\\sheet\\\\MakeSheet.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport * as XLSX from 'xlsx';\nimport { Div0, Table0, Thead0, Th0, Tr0 } from './style';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction DrawSheet() {\n  _s();\n\n  const readExcel = file => {\n    const promise = new Promise((resolve, reject) => {\n      const fileReader = new FileReader();\n      fileReader.readAsArrayBuffer(file);\n\n      fileReader.onload = e => {\n        const bufferArray = e.target.result;\n        const wb = XLSX.read(bufferArray, {\n          type: 'buffer'\n        });\n        const wsname = wb.SheetNames[0];\n        const ws = wb.Sheets[wsname];\n        const data = XLSX.utils.sheet_to_json(ws);\n        resolve(data);\n      };\n\n      fileReader.onerror = error => {\n        reject(error);\n      };\n    });\n    promise.then(d => {\n      setItems(d);\n    });\n  };\n\n  const [items, setItems] = useState([]);\n  return /*#__PURE__*/_jsxDEV(Div0, {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      onChange: e => {\n        const file = e.target.files[0];\n        readExcel(file);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(Table0, {\n      className: \"table\",\n      children: [/*#__PURE__*/_jsxDEV(Thead0, {\n        children: /*#__PURE__*/_jsxDEV(Tr0, {\n          children: [/*#__PURE__*/_jsxDEV(Th0, {\n            scope: \"col\",\n            children: \"username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Th0, {\n            className: \"th1\",\n            scope: \"col\",\n            children: \"\\u6027\\u5225\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 39,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Th0, {\n            className: \"th1\",\n            scope: \"col\",\n            children: \"\\u6B21\\u6578\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 40,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Th0, {\n            className: \"th1\",\n            scope: \"col\",\n            children: \"\\u5E74\\u7D00\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 41,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: items.map(d => /*#__PURE__*/_jsxDEV(Tr0, {\n          children: [/*#__PURE__*/_jsxDEV(Th0, {\n            children: d.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 48,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(Th0, {\n            className: \"th1\",\n            children: d.gender\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(Th0, {\n            className: \"th1\",\n            children: d.number\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 50,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(Th0, {\n            className: \"th1\",\n            children: d.old\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 51,\n            columnNumber: 37\n          }, this)]\n        }, d.ID, true, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 33\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 13\n  }, this);\n}\n\n_s(DrawSheet, \"57SJuCrh2mzvqkAcA91jrZTeEcE=\");\n\n_c = DrawSheet;\nexport default DrawSheet;\n\nvar _c;\n\n$RefreshReg$(_c, \"DrawSheet\");","map":{"version":3,"names":["React","useState","XLSX","Div0","Table0","Thead0","Th0","Tr0","DrawSheet","readExcel","file","promise","Promise","resolve","reject","fileReader","FileReader","readAsArrayBuffer","onload","e","bufferArray","target","result","wb","read","type","wsname","SheetNames","ws","Sheets","data","utils","sheet_to_json","onerror","error","then","d","setItems","items","files","map","username","gender","number","old","ID"],"sources":["E:/fork/frontend-111406/frontend-111406/src/common/sheet/MakeSheet.js"],"sourcesContent":["import React,{useState} from \"react\";\r\nimport * as XLSX from 'xlsx';\r\nimport{Div0,Table0,Thead0,Th0,Tr0}from'./style';\r\n\r\nfunction DrawSheet(){\r\n\r\n        const readExcel=(file)=>{\r\n            const promise=new Promise((resolve,reject)=>{\r\n                const fileReader=new FileReader();\r\n                fileReader.readAsArrayBuffer(file)\r\n                fileReader.onload=(e)=>{\r\n                    const bufferArray=e.target.result;\r\n                    const wb=XLSX.read(bufferArray,{type:'buffer'});\r\n                    const wsname= wb.SheetNames[0];\r\n                    const ws=wb.Sheets[wsname];\r\n                    const data=XLSX.utils.sheet_to_json(ws);\r\n                    resolve(data)\r\n                };\r\n                fileReader.onerror=(error)=>{\r\n                    reject(error);\r\n                };\r\n            });\r\n            promise.then((d)=>{\r\n                setItems(d);\r\n            });\r\n        };\r\n        const [items,setItems]=useState([]);\r\n        return (\r\n            <Div0>\r\n                <input type='file' onChange={(e)=>{\r\n                    const file=e.target.files[0];\r\n                    readExcel(file);\r\n                }}>\r\n                </input>\r\n                <Table0 className=\"table\">\r\n                    <Thead0>\r\n                        <Tr0>\r\n                        <Th0 scope=\"col\">username</Th0>\r\n                        <Th0 className=\"th1\" scope=\"col\">性別</Th0>\r\n                        <Th0 className=\"th1\" scope=\"col\">次數</Th0>\r\n                        <Th0 className=\"th1\" scope=\"col\">年紀</Th0>\r\n                        </Tr0>\r\n                    </Thead0>\r\n                    <tbody>\r\n                        {\r\n                            items.map((d)=>(\r\n                                <Tr0 key={d.ID}>\r\n                                    <Th0>{d.username}</Th0>\r\n                                    <Th0 className=\"th1\">{d.gender}</Th0>\r\n                                    <Th0 className=\"th1\">{d.number}</Th0>\r\n                                    <Th0 className=\"th1\">{d.old}</Th0>\r\n                                </Tr0>\r\n                            ))\r\n                        }\r\n                    </tbody>\r\n            </Table0>\r\n            </Div0>\r\n        );}\r\nexport default DrawSheet;"],"mappings":"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"},"metadata":{},"sourceType":"module"}